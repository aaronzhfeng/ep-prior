%%%% EP-Prior Paper for IJCAI-ECAI 2026

\typeout{EP-Prior: Interpretable ECG Representations via Electrophysiology Constraints}

\documentclass{article}
\pdfpagewidth=8.5in
\pdfpageheight=11in

\usepackage{ijcai26}
\usepackage{times}
\usepackage{soul}
\usepackage{url}
\usepackage[hidelinks]{hyperref}
\usepackage[utf8]{inputenc}
\usepackage[small]{caption}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{booktabs}
\usepackage{pifont}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage[switch]{lineno}
\usepackage{xcolor}
% \usepackage{subcaption}  % REMOVED: causes lineno positioning issues in two-column

% Comment out this line in the camera-ready submission
\linenumbers

\urlstyle{same}

\newtheorem{definition}{Definition}
\newtheorem{proposition}{Proposition}
\newtheorem{corollary}{Corollary}

% Placeholder command for figures
\newcommand{\placeholderfig}[2]{%
  \begin{center}
    \fbox{\parbox{#1}{%
      \vspace{2em}
      \centering
      \textcolor{gray}{\textbf{[PLACEHOLDER]}\\#2}
      \vspace{2em}
    }}
  \end{center}
}

\pdfinfo{
/TemplateVersion (IJCAI.2026.0)
}

\title{EP-Prior: Interpretable ECG Representations via Electrophysiology Constraints}

% Anonymous submission
\author{
Anonymous Author(s)
\affiliations
Anonymous Institution
\emails
anonymous@example.com
}

\begin{document}

\maketitle

\begin{abstract}
Accurate ECG classification with limited labeled data requires representations that are both sample-efficient and clinically interpretable. We present EP-Prior, a self-supervised framework that aligns learned ECG representations with cardiac electrophysiology. The encoder produces a prescribed, wave-factorized latent space $(z_P, z_{QRS}, z_T, z_{HRV})$, and an EP-constrained Gaussian-wave decoder reconstructs signals under soft priors on P/QRS/T ordering, refractory periods, and physiologic duration bounds. This structure makes each component inspectable and supports factor-level probes and interventions. We provide a PAC-Bayes analysis that interprets EP constraints as an electrophysiology-informed prior, reducing the complexity term and predicting the largest gains in few-shot regimes. On PTB-XL, EP-Prior improves 10-shot AUROC from 0.627 to 0.699 (+0.072) over a capacity-matched generic SSL baseline, with gains across all five diagnostic superclasses. Ablations show the constraints are necessary: removing the EP losses drops 10-shot AUROC to 0.519, below the baseline. EP-Prior illustrates how embedding domain structure as model priors can jointly improve explainability and label efficiency.
\end{abstract}

%==============================================================================
\section{Introduction}
%==============================================================================

ECG-based cardiac diagnosis is critical for early detection of arrhythmias and conduction abnormalities~\cite{goldberger2000physiobank}. While deep learning has achieved strong performance on large datasets~\cite{wagner2020ptbxl}, significant challenges remain in low-data regimes, particularly for wearable and portable devices:

\begin{itemize}
    \item Many clinically important arrhythmias appear in $<$1\% of records
    \item Personalizing models to individual patients requires adaptation from only a handful of examples
    \item Deploying to new ECG hardware often means starting over with limited labeled data
\end{itemize}

Equally important is the need for \textbf{interpretability}. Black-box models that achieve high accuracy but provide no insight into \emph{what} they have learned face barriers to clinical adoption. Regulatory frameworks increasingly require explainable AI for medical devices.

Cardiac electrophysiology provides rich mathematical structure: P-QRS-T wave morphology, conduction dynamics, refractory constraints. This knowledge is well-understood clinically but rarely exploited in representation learning. Prior work uses EP knowledge in ECGI (inverse problems) but not for learning interpretable representations.

We propose \textbf{EP-Prior}, which injects this EP knowledge as architectural priors in a self-supervised framework:
\begin{enumerate}
    \item A \textbf{structured latent space} where encoder outputs decompose into $(z_P, z_{QRS}, z_T, z_{HRV})$
    \item An \textbf{EP-constrained decoder} using a Gaussian wave model that reconstructs ECG signals
    \item \textbf{Soft constraint losses} enforcing temporal ordering, refractory periods, and duration bounds
\end{enumerate}

Our contributions are threefold. First, we achieve \textbf{interpretability} through a structured latent space with physiologically meaningful components, validated via intervention tests and concept predictability. Second, we provide a \textbf{theoretical} PAC-Bayes-motivated analysis explaining \emph{why} EP constraints help in low-data regimes. Third, we demonstrate \textbf{empirically} competitive few-shot classification on PTB-XL with inspectable, concept-level parameters.

What sets EP-Prior apart from prior physiology-aware ECG methods? Those approaches inject domain knowledge via data augmentation or loss terms, but treat the learned representations as black boxes. We encode electrophysiology as \emph{architectural constraints} that shape the hypothesis class itself. The structured latent decomposition $(z_P, z_{QRS}, z_T, z_{HRV})$ is \emph{prescribed} by cardiac physiology, not discovered by the model. The EP-constrained decoder parameterizes each wave with explicit timing and morphology variables (Gaussian waves), and we enforce ordering and refractory structure through soft EP constraint losses. This design enables both interpretability (each latent has known meaning) and theoretical analysis (constrained hypothesis class has reduced complexity). Our ablation demonstrates this distinction is critical: structured latents without EP constraints perform \emph{worse} than unstructured baselines.

%==============================================================================
\section{Related Work}
\label{sec:relatedwork}
%==============================================================================

\textbf{Self-supervised learning for ECG.}
Self-supervised learning (SSL) is increasingly used to leverage large unlabeled ECG corpora, building on generic contrastive and predictive objectives such as SimCLR~\cite{chen2020simclr} and CPC~\cite{oord2018cpc}, and adapting augmentations and pretext tasks to physiological time series~\cite{mehari2022ssl}.
Representative ECG-specific SSL methods include contrastive learning across time, leads, and patients (CLOCS~\cite{kiyasseh2021clocs}; PCLR~\cite{diamant2022pclr}), lead-aware objectives (Dense Lead Contrast~\cite{liu2023denseleadcontrast}), and physiology-motivated contrastive strategies (PhysioCLR~\cite{physioclr2025}).
Recent work has also explored masked-modeling style pretraining for multi-lead ECG~\cite{sawano2024maeecg} and scaling up to ECG foundation models (ECG-FM~\cite{mckeen2025ecgfm}).
We take a different route: EP-Prior encodes electrophysiological structure directly as a \emph{model prior} through an EP-constrained decoder and wave-factorized latent variables, rather than relying on learned invariances from augmentations or scale.

\textbf{Few-shot ECG classification.}
Label-efficient ECG modeling is commonly pursued via transfer learning and fine-tuning pipelines~\cite{weimann2021transfer}, and via explicit few-shot/meta-learning benchmarks and methods for ECG classification~\cite{palczynski2022fewshot}.
These approaches can substantially improve adaptation with limited labels, but typically operate on latent spaces that are not constrained to correspond to clinically meaningful ECG factors.
Our goal is different: we aim to reduce effective sample complexity through a physiology-aligned inductive bias. The representation is explicitly organized around interpretable wave factors, making low-shot learning less reliant on purely algorithmic adaptation.

\textbf{PQRST-structured methods.}
A complementary line of work bakes ECG structure directly into supervised architectures.
MINA~\cite{hong2019mina} uses multilevel attention over beat-, rhythm-, and frequency-level representations to capture hierarchical ECG structure.
Classical ECG processing and delineation pipelines remain influential (e.g., QRS detection via Pan--Tompkins~\cite{pantompkins1985}), but structured supervision often requires delineation quality and label availability to hold up across settings.
In contrast, EP-Prior learns PQRST-consistent latent factors \emph{without} requiring labeled segmentation; the structure emerges from the EP-constrained generative decoder during SSL pretraining.

\input{assets/table1_related_work.tex}

\textbf{Interpretable ECG representations.}
Interpretability in ECG AI is often pursued either through post-hoc explanations or intrinsically interpretable representations.
Disentanglement methods such as $\beta$-VAE~\cite{higgins2017betavae} and $\beta$-TCVAE~\cite{chen2018betatcvae} can encourage factorized latents, but the learned factors are not guaranteed to align with electrophysiological semantics.
Recent ECG-focused work has explicitly examined the accuracy--explainability trade-off for VAE-based explanations~\cite{patlatzoglou2025explainability}, while SHAP-based interpretability has been applied to ECG models in clinically oriented studies~\cite{zhang2021shap}; recent surveys summarize broader explainable deep learning practice in ECG classification~\cite{manimaran2025xai}.
Where these methods provide explanations after the fact, we target \emph{intrinsic} interpretability: prescribed EP-aligned factors (wave morphology and timing) that enable mechanistic inspection and factor-level interventions.

\textbf{Sample complexity and architectural priors.}
Several theoretical lines motivate why architecture and priors can improve data efficiency.
Work on architectural priors and inductive bias shows that constraining the hypothesis class can reduce sample complexity~\shortcite{behboodi2024}.
For time series specifically, learning theory has developed tools for dependent data (e.g., stability/mixing-based generalization in Kuznetsov \& Mohri~\cite{kuznetsov2015learning,kuznetsov2018online}).
PAC-Bayes provides another route to generalization for randomized predictors~\cite{mcallester1999,alquier2008pacbayes}, and has been recently specialized to stable dynamical systems~\cite{eringis2023pacbayes}.
EP-Prior instantiates this intuition concretely: we pair a physiology-motivated architectural prior (EP-constrained generative decoder with explicit wave factors) with theory linking this restriction to improved low-shot behavior.

\textbf{Physics-informed cardiac modeling.}
Physics-informed neural networks (PINNs) and PDE/ODE-constrained learning incorporate cardiac electrophysiology for simulation and inverse problems, including activation mapping and related tasks~\cite{sahli2020pinns}.
Related physics-constrained deep learning approaches have also been developed for inverse electrocardiography (ECGi) settings~\cite{xie2022physicsconstrained}.
In parallel, synthetic ECG generators such as the dynamical model of McSharry et al.~\cite{mcsharry2003dynamical} and ECGSYN~\cite{clifford2006ecgsyn} provide structured forward models that can be used for data generation and analysis.
Rather than solving a high-fidelity inverse physics problem (as in PINN/ECGi work), we use a lightweight EP-consistent forward structure as a representation prior within SSL, targeting interpretable factors and label-efficient downstream learning.

Table~\ref{tab:related_work} summarizes these distinctions. Prior ECG SSL methods typically optimize for transferable embeddings but do not provide explicit EP-factor semantics; supervised structured models incorporate PQRST structure but rely on labels or delineation; physics-informed approaches target inverse/simulation problems rather than representation learning.
EP-Prior attempts to unify \emph{SSL}, \emph{explicit PQRST/EP factorization}, and \emph{theory-backed data efficiency} in a single framework.

%==============================================================================
\section{Theoretical Foundation}
%==============================================================================

\subsection{Problem Setup}

We consider ECG signals $x_t \in \mathbb{R}^{12}$ (12-lead) with labels $y \in \{1, \ldots, K\}$. ECG signals arise from a latent cardiac state-space model:
\vspace{2pt}
\begin{equation}
    x_t = g(z_t) + \epsilon_t, \quad z_{t+1} = f_{EP}(z_t) + \eta_t
\end{equation}
\vspace{2pt}
where $f_{EP}$ encodes cardiac EP dynamics (atrial depolarization, AV conduction, ventricular depolarization/repolarization).

\begin{definition}[EP-Structured Encoder Class]
The EP-structured hypothesis class constrains encoder outputs to physiologically meaningful components:
\vspace{2pt}
\begin{equation}
    \mathcal{H}_{EP} = \{h_\theta : h_\theta(x) = (z_P, z_{QRS}, z_T, z_{HRV})\}
\end{equation}
\vspace{2pt}
where the decoder $d_\phi$ is EP-constrained (enforces wave ordering and refractory periods).
\end{definition}

This structured hypothesis class is \emph{smaller} than generic encoder classes, which is the key to sample efficiency as we show next.

\subsection{PAC-Bayes Motivation}

We use PAC-Bayes theory to \emph{motivate} our architectural choices and \emph{predict} where gains should appear. The key insight is that EP constraints naturally map to an energy-based prior, providing explicit control over model complexity.

\textbf{Standard PAC-Bayes bound~\cite{mcallester1999}:}
\vspace{2pt}
\begin{equation}
    \mathcal{R}(Q) \leq \hat{\mathcal{R}}(Q) + \sqrt{\frac{\text{KL}(Q\|P) + \log(2n/\delta)}{2n}}
\end{equation}
\vspace{2pt}

Why does this matter for low-data regimes? The bound has two terms: empirical risk $\hat{\mathcal{R}}(Q)$ and a complexity penalty $\propto \text{KL}(Q\|P)/\sqrt{n}$. When $n$ is small (few-shot), the complexity term dominates. Choosing a prior $P$ that assigns high probability to EP-consistent hypotheses reduces KL divergence for data that follows cardiac physiology.

The design implication is direct: defining $P = P_{EP}$ (an EP-informed prior) enables low KL divergence when data is EP-consistent. The $\sqrt{1/n}$ scaling predicts \textbf{largest gains in few-shot regimes}.

\begin{proposition}[EP Prior Decomposition]
Define the EP prior as $P_{EP}(\theta) \propto P_0(\theta) \exp(-\lambda V_{EP}(\theta))$ where:
\vspace{2pt}
\begin{align}
    V_{EP}(\theta) = &\text{ReLU}(\tau_P - \tau_{QRS}) + \text{ReLU}(\tau_{QRS} - \tau_T) \nonumber \\
    &+ \text{ReLU}(\Delta_{PR}^{min} - |\tau_{QRS} - \tau_P|)
\end{align}
\vspace{2pt}
Then $\text{KL}(Q \| P_{EP}) = \text{KL}(Q \| P_0) + \lambda \mathbb{E}_Q[V_{EP}] + \text{const}$.
\end{proposition}

The intuition is straightforward: $V_{EP}(\theta)$ is zero when timing constraints are satisfied (P before QRS before T, with minimum PR interval). Training with EP constraint losses pushes the posterior $Q$ toward low $V_{EP}$ regions, reducing KL to the EP prior. This explains the \emph{catastrophic failure} we observe in ablations without EP constraints: the model explores a much larger hypothesis space, inflating the complexity term.

This analysis yields a testable prediction: EP-Prior should show its largest advantage in few-shot regimes (where KL reduction dominates) and converge to baselines at high-$n$ (where empirical risk dominates). We validate this in Section~\ref{sec:experiments}.

%==============================================================================
\section{Method: EP-Prior}
%==============================================================================

\subsection{Architecture Overview}

Figure~\ref{fig:architecture} illustrates the EP-Prior framework. An ECG signal passes through a structured encoder producing wave-specific latents, which are decoded via an EP-constrained Gaussian wave model.

\begin{figure*}[t]
    \centering
    \includegraphics[width=0.85\textwidth]{figures/fig1_architecture.png}
    \caption{EP-Prior framework. The encoder produces structured latent representations $(z_P, z_{QRS}, z_T, z_{HRV})$ with attention-pooled heads. The EP-constrained decoder reconstructs the signal using a Gaussian wave model with soft physiological constraints on timing, refractory periods, and durations.}
    \label{fig:architecture}
\end{figure*}

\subsection{Structured Encoder}

The encoder $h_\theta$ maps 12-lead ECG to a structured latent space:
\vspace{2pt}
\begin{equation}
    h_\theta(x) = (z_P, z_{QRS}, z_T, z_{HRV}) \in \mathbb{R}^{d_P} \times \mathbb{R}^{d_{QRS}} \times \mathbb{R}^{d_T} \times \mathbb{R}^{d_{HRV}}
\end{equation}
\vspace{2pt}

We use xresnet1d50~\cite{mehari2022ssl} as backbone, producing a temporal feature map $F \in \mathbb{R}^{B \times D \times L}$. For each wave $w \in \{P, QRS, T\}$:
\begin{enumerate}
    \item Compute attention logits $a_w(t)$ over $L$ positions
    \item Get attention weights $\alpha_w = \text{softmax}(a_w)$
    \item Compute wave-pooled feature $h_w = \sum_t \alpha_w(t) F[:,:,t]$
    \item Project to latent $z_w = W_w h_w$
\end{enumerate}
HRV~\cite{hrvtaskforce1996} uses global average pooling followed by an MLP.

\subsection{EP-Constrained Decoder}

We use a \textbf{Gaussian wave state-space model}~\cite{mcsharry2003dynamical,clifford2006ecgsyn}:
\vspace{2pt}
\begin{equation}
    \hat{x}_t = \sum_{w \in \{P, QRS, T\}} g_w \cdot A_w \cdot \exp\left(-\frac{(t - \tau_w)^2}{2\sigma_w^2}\right)
    \label{eq:decoder}
\end{equation}
\vspace{2pt}
where $(A_w, \tau_w, \sigma_w, g_w)$ are amplitude, timing, width, and presence gate for each wave. Parameters are predicted from the corresponding latent: $\tau_w = T \cdot \text{sigmoid}(\text{MLP}_\tau(z_w))$, $\sigma_w = \text{softplus}(\text{MLP}_\sigma(z_w)) + \sigma_{min}$.

To capture Q/R/S morphology~\cite{pantompkins1985}, we use a mixture of $K=3$ Gaussians with shared center $\tau_{QRS}$ and small learned offsets. Timing parameters $(\tau_w, \sigma_w)$ are shared across leads; amplitudes $A_w$ are per-lead, reflecting that electrical event timing is global while projection amplitude varies by lead orientation.

\subsection{Training Objectives}

The total loss combines three terms:
\begin{equation}
    \mathcal{L} = \mathcal{L}_{recon} + \lambda_{EP}\mathcal{L}_{EP} + \lambda_{contrast}\mathcal{L}_{contrast}
\end{equation}

The reconstruction term is $\mathcal{L}_{recon} = \|x - \hat{x}\|_2^2$. The EP constraints are soft penalties:
\begin{flalign}
    & \quad \mathcal{L}_{order} = \text{softplus}(\tau_P - \tau_{QRS}) + \text{softplus}(\tau_{QRS} - \tau_T) & \\
    & \quad \mathcal{L}_{PR} = \text{softplus}(\Delta_{PR}^{min} - (\tau_{QRS} - \tau_P)) & \\
    & \quad \mathcal{L}_{QT} = \text{softplus}(\Delta_{QT}^{min} - (\tau_T - \tau_{QRS})) & \\
    & \quad \mathcal{L}_{\sigma} = \sum_w \text{softplus}(\sigma_{min} - \sigma_w) + \text{softplus}(\sigma_w - \sigma_{max}) &
\end{flalign}

Constraints are gated by wave presence: $\mathcal{L}_{order} \leftarrow \mathcal{L}_{order} \cdot g_P \cdot g_{QRS} \cdot g_T$. This allows the model to handle pathological cases (e.g., absent P-wave in AFib) gracefully.

We optionally add an NT-Xent contrastive loss~\cite{chen2020simclr} on concatenated latents from augmented views.

%==============================================================================
\section{Experiments}
\label{sec:experiments}
%==============================================================================

\subsection{Experimental Setup}

\textbf{Dataset:} PTB-XL~\cite{wagner2020ptbxl} containing 21,837 12-lead ECG records (10s, 500Hz downsampled to 100Hz). PTB-XL provides 71 diagnostic statements grouped into 5 superclasses: NORM (normal), MI (myocardial infarction), STTC (ST-T changes), CD (conduction defects), and HYP (hypertrophy). We evaluate on the 5 superclasses following standard practice.

\textbf{Task definition:} Multi-label classification where each ECG can have multiple diagnoses. We report class-average AUROC, computing AUROC per class then averaging.

\textbf{Few-shot evaluation:} We subsample training sets to $\{10, 50, 100, 500\}$ examples per class using stratified sampling, ensuring each class has the specified number of positive examples. Models are evaluated on the full held-out test set (n=2,163). Results averaged over 3 seeds with standard deviation reported.

\textbf{Baselines:}
\begin{itemize}
    \item \textbf{Supervised:} Train from scratch on limited labels (26.0M params)
    \item \textbf{Generic SSL:} Same encoder backbone (xresnet1d50, 25.6M params) and latent dimension (256), but unstructured latent space and generic 3-layer MLP decoder (total 26.0M params)
\end{itemize}
EP-Prior uses the same backbone with structured heads and EP-constrained decoder (total 26.2M params). All SSL methods are pretrained on PTB-XL training set before few-shot evaluation. We compare against Generic SSL as our primary baseline to isolate the effect of EP constraints; comparison against PhysioCLR~\cite{physioclr2025} is deferred to future work pending code release.

\textbf{Implementation:} We use PyTorch Lightning with AdamW optimizer (lr=$10^{-3}$), batch size 64, and train for 200 epochs. Loss weights: $\lambda_{recon}=1.0$, $\lambda_{EP}=0.5$, $\lambda_{contrast}=0.1$.

\subsection{Few-Shot Classification}

Table~\ref{tab:fewshot} shows AUROC on PTB-XL few-shot evaluation. EP-Prior achieves the largest gains in low-shot regimes, validating our theoretical prediction.

\input{assets/table2_fewshot.tex}

Consistent with the PAC-Bayes prediction, EP-Prior's advantage is largest at low-$n$ and diminishes as labeled data increases.

\begin{figure}[t]
    \centering
    \includegraphics[width=\columnwidth]{figures/fig2_intervention_heatmap.pdf}
    \caption{Intervention selectivity heatmap. Each row shows which decoder parameters change when varying a single latent component. Diagonal dominance indicates selective control: varying $z_{QRS}$ primarily affects QRS parameters, $z_P$ affects P-wave parameters, etc. Off-diagonal leakage is $<$10\% across all components.}
    \label{fig:intervention}
\end{figure}

\begin{figure*}[t]
    \centering
    \includegraphics[width=0.85\textwidth]{figures/fig5_latent_tsne.pdf}
    \caption{t-SNE visualization of EP-Prior's latent space, colored by PTB-XL diagnostic superclass. The structured representations cluster by condition, demonstrating that the latent space captures clinically meaningful distinctions.}
    \label{fig:tsne}
\end{figure*}

\subsection{Interpretability Evaluation}

We validate interpretability through three quantitative tests:

\subsubsection{Concept Predictability}

We train linear probes from individual latent components to predict corresponding pathologies (Table~\ref{tab:concept_pred}).

\input{assets/table3_concept_pred.tex}

\subsubsection{Intervention Selectivity}

We vary one latent component while holding others fixed and measure changes in decoded parameters (Figure~\ref{fig:intervention}).

\textbf{Leakage metric:} We define leakage as the normalized change in off-target parameters when varying a single latent. For latent $z_i$ and parameter group $j \neq i$: $\text{Leakage}_{i \to j} = \frac{\|\Delta \theta_j\|}{\|\Delta \theta_i\|}$ where $\theta_j$ denotes parameters controlled by $z_j$. Low leakage indicates selective control.

The intervention heatmap (Figure~\ref{fig:intervention}) confirms diagonal dominance: varying $z_{QRS}$ primarily affects QRS parameters while P-wave and T-wave parameters remain approximately invariant (off-diagonal leakage $<$10\%). Structured latents thus provide \emph{selective} control over corresponding waveform components, unlike post-hoc visualization methods like saliency maps.

\subsubsection{Failure Mode Stratification}

Table~\ref{tab:stratified} reports per-superclass performance, showing improvements across all five diagnostic categories.

\input{assets/table4_per_condition.tex}

\subsection{Ablation Studies}

Table~\ref{tab:ablation} reveals a \textbf{critical finding}: EP constraints are essential for EP-Prior's performance. Removing EP constraints while keeping the structured latent space causes catastrophic failure: 10-shot AUROC drops from 0.699 to 0.519, falling \emph{below} the baseline (0.627). This 0.180 AUROC drop proves that structured latents alone are insufficient; the EP constraint losses provide the inductive bias that enables sample-efficient learning.

\input{assets/table5_ablation.tex}

Why does this happen? Without EP constraints, the structured latent decomposition becomes an architectural bottleneck rather than an advantage. The model must learn to coordinate four separate latent groups $(z_P, z_{QRS}, z_T, z_{HRV})$ without guidance about what each should encode, increasing effective capacity requirements with no compensating inductive bias. The EP constraints anchor each latent to its intended physiological meaning, converting the decomposition from a liability into an advantage.

\subsection{Latent Space Visualization}

Figure~\ref{fig:tsne} shows t-SNE projections of the learned latent space. EP-Prior's representations cluster by diagnostic category, suggesting that the structured latents capture clinically meaningful variation. NORM samples (green) form a tight cluster, while pathological conditions spread according to their physiological similarity: MI and STTC (both involving repolarization abnormalities) partially overlap, while CD (conduction defects) forms a distinct region reflecting its association with QRS morphology changes. This organization emerges without any label supervision during pretraining, indicating that the EP-constrained decoder encourages the encoder to learn physiologically grounded features.

\subsection{ECG Reconstruction and Decomposition}

Figure~\ref{fig:reconstruction} shows qualitative examples of EP-Prior's wave decomposition, demonstrating interpretable intermediate representations. The decoder explicitly decomposes each ECG into P-wave (atrial depolarization), QRS complex (ventricular depolarization), and T-wave (ventricular repolarization) components. Each component is parameterized by timing ($\tau$), width ($\sigma$), and amplitude ($A$), providing clinicians with inspectable intermediate values. For example, a widened QRS ($\sigma_{QRS} > 120$ms) or prolonged QT interval ($\tau_T - \tau_{QRS} > 450$ms) can be directly read from the decoder outputs, enabling verification that the model attends to clinically relevant features.

\begin{figure}[t]
    \centering
    \includegraphics[width=\columnwidth]{figures/fig4_reconstruction_examples.pdf}
    \caption{ECG reconstruction with wave decomposition. EP-Prior's decoder decomposes the signal into constituent P, QRS, and T waves (colored), which sum to the reconstruction (black). Clinicians can inspect predicted timing ($\tau$) and morphology ($\sigma$, $A$) for each wave component.}
    \label{fig:reconstruction}
\end{figure}

%==============================================================================
\section{Discussion}
%==============================================================================

\subsection{Clinical Implications}
EP-Prior is designed for clinical settings where both label scarcity and accountability are key constraints. In many hospitals, new diagnostic models must be adapted to local patient populations, acquisition protocols, or under-represented conditions with limited expert annotation. In our PTB-XL few-shot evaluation (macro AUROC over five diagnostic superclasses), EP-Prior improves from 0.627 to 0.699 in the 10-shot regime (+0.072 absolute), and maintains gains at 50-shot (0.790 vs 0.739) and 100-shot (0.805 vs 0.766), with diminishing benefit at 500-shot (0.826 vs 0.812). In per-condition analysis, EP-Prior improves across all five superclasses, with the largest gains on MI (0.806 vs 0.770) and HYP (0.791 vs 0.770), consistent with the intuition that morphology-aligned priors are most helpful when waveform structure is diagnostic. These results suggest a practical deployment path: pretrain once, then fine-tune with tens (not thousands) of labeled local cases to reach competitive performance.

Beyond accuracy, EP-Prior exposes wave-level parameters (timing, width, amplitude) and structured factors $(z_P,z_{QRS},z_T,z_{HRV})$ that can be reviewed by clinicians. Component probes show that each factor alone retains $>$75\% of the full model's performance and intervention tests exhibit low off-diagonal leakage ($<$10\%), indicating that changes to $z_{QRS}$ primarily affect QRS morphology without corrupting P/T components. We envision several integration patterns. As a ``second reader'' for cardiologists, EP-Prior can surface both predicted diagnoses and the waveform component driving the decision (e.g., QRS widening), supporting faster adjudication. In primary-care or ED triage settings, a high-sensitivity screening model with interpretable intermediate parameters could help non-specialists understand why an ECG is flagged. For monitoring (wearables or ICU telemetry, which we do not evaluate here), the same factorization could support event detection by tracking changes in specific components over time.

This kind of interpretability aligns with emerging governance expectations for medical AI. The FDA's AI/ML SaMD Action Plan emphasizes a total product lifecycle view with transparent performance characterization; the EU AI Act (Regulation (EU) 2024/1689; Articles 9/11/14) specifies requirements for risk management, technical documentation, and effective human oversight for high-risk systems. EP-Prior does not ``solve'' compliance, but its inspectable intermediate parameters provide a concrete interface for documentation, clinician oversight, and post-market monitoring.

\subsection{Theoretical Insights}
Our PAC-Bayes lens predicts that informative priors should matter most when $n$ is small because the complexity term scales as $1/\sqrt{n}$. The observed sample-efficiency curve matches this qualitative prediction: the absolute gain is largest at 10-shot (+0.072 AUROC) and decreases with more labels (+0.014 at 500-shot). The ablation study further clarifies \emph{what} constitutes the effective prior: removing EP constraints while keeping the structured latent space drops performance to 0.519 AUROC (10-shot), below the capacity-matched baseline (0.627). This suggests that architectural decomposition alone can become a harmful bottleneck unless coupled to a physiologically meaningful constraint that anchors the latent semantics. Practically, it cautions against ``interpretable-by-construction'' designs without a mechanism that enforces the intended factor alignment.

\subsection{Limitations}
Our current evidence is limited in several ways. (1) All experiments are on PTB-XL; generalization to other cohorts, devices, and demographics is unknown. (2) We focus on five diagnostic superclasses rather than the full SCP code taxonomy; fine-grained rare arrhythmias remain untested. (3) Signals are 12-lead, clinical-quality recordings; robustness to noise, motion artifacts, and lead reduction (single-/few-lead) is not evaluated. (4) The Gaussian-wave decoder and fixed P/QRS/T factorization are simplified and may not capture complex rhythms (e.g., AF with absent P-waves or ventricular fibrillation). (5) We compare primarily to a capacity-matched generic SSL baseline; broader benchmarking against additional physiology-aware SSL methods is needed. (6) We do not provide prospective clinical validation or human-factors studies assessing whether the explanations improve decision-making.

\subsection{Future Work}
Near-term work will prioritize multi-dataset evaluation (e.g., CPSC, Chapman--Shaoxing) and domain-shift studies (new hospitals, different acquisition devices), followed by lead-reduction and noise-robust training to target ambulatory and wearable ECG. Methodologically, richer EP decoders (learnable waveforms, adaptive segmentation, or lead-aware geometry) and stronger baselines will clarify when EP priors help or hurt. Longer-term, we plan multimodal extensions (ECG with clinical notes or labs) and prospective studies that measure clinical utility, calibration, and safety monitoring under a total product lifecycle approach.

%==============================================================================
\section{Conclusion}
%==============================================================================

We presented EP-Prior, a self-supervised framework that learns \textbf{interpretable} ECG representations by encoding cardiac electrophysiology as architectural priors. The structured latent space $(z_P, z_{QRS}, z_T, z_{HRV})$ provides clinically meaningful, inspectable representations validated through intervention tests and concept predictability. On PTB-XL, EP-Prior achieves +0.072 AUROC improvement in 10-shot classification across all five diagnostic categories. The ablation tells a cautionary tale: structured latents alone perform worse than baseline. This validates our PAC-Bayes-motivated design principle: domain knowledge must be embedded as constraint losses, not just architectural structure, to achieve both explainability and sample efficiency.

%==============================================================================
% References
%==============================================================================

\bibliographystyle{named}
\bibliography{ep_prior}

\end{document}

